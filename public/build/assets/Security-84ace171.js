import{c as k,r as o,f as S,u as C,j as s,v as m,E as h,R as M,h as P,n as c}from"./app-4d58a1c1.js";import{S as E}from"./UserProfile-d5652f76.js";import"./crown-80023408.js";import"./coins-89cc77ad.js";import"./credit-card-11b7fc7f.js";import"./gift-a60ca994.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p=k("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);const B=({user:R})=>{const[e,n]=o.useState({old_password:"",password:"",password_confirmation:""}),[i,x]=o.useState(!1),[l,w]=o.useState(!1),[d,g]=o.useState(!1),[r,u]=o.useState(!1),j=S(),{logout:N}=C(),v=()=>!e.old_password||!e.password||!e.password_confirmation?(c.error("Vui lòng điền đầy đủ thông tin"),!1):e.password.length<6?(c.error("Mật khẩu mới phải có ít nhất 6 ký tự"),!1):e.password!==e.password_confirmation?(c.error("Mật khẩu mới không khớp"),!1):!0,b=async a=>{var _,f;if(a.preventDefault(),!!v()){u(!0);try{const t=await P.post("/reset-password",e);t.data.message&&(c.success(t.data.message),setTimeout(async()=>{await N(),j("/")},1500))}catch(t){console.error("Error changing password:",t);const y=((f=(_=t.response)==null?void 0:_.data)==null?void 0:f.error)||"Có lỗi xảy ra khi đổi mật khẩu";c.error(y)}finally{u(!1)}}};return s.jsx("div",{className:"sec-container",children:s.jsxs("div",{className:"sec-content",children:[s.jsxs("div",{className:"sec-header",children:[s.jsx(E,{className:"sec-header__icon"}),s.jsx("h4",{className:"sec-header__title",children:"Bảo Mật Tài Khoản"})]}),s.jsx("div",{className:"sec-warning",children:s.jsxs("div",{className:"sec-warning__content",children:[s.jsx("svg",{className:"sec-warning__icon",viewBox:"0 0 20 20",fill:"currentColor",children:s.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),s.jsx("p",{className:"sec-warning__text",children:"Sau khi đổi mật khẩu thành công, bạn sẽ được tự động đăng xuất và cần đăng nhập lại."})]})}),s.jsxs("form",{onSubmit:b,className:"sec-form",children:[s.jsxs("div",{className:"sec-form__group",children:[s.jsx("label",{className:"sec-form__label",children:"Mật khẩu cũ"}),s.jsxs("div",{className:"sec-form__input-wrapper",children:[s.jsx(p,{className:"sec-form__icon"}),s.jsx("input",{type:i?"text":"password",value:e.old_password,onChange:a=>n({...e,old_password:a.target.value}),placeholder:"Nhập mật khẩu cũ",className:"sec-form__input",disabled:r}),s.jsx("button",{type:"button",onClick:()=>x(!i),className:"sec-form__toggle",children:i?s.jsx(m,{}):s.jsx(h,{})})]})]}),s.jsxs("div",{className:"sec-form__group",children:[s.jsx("label",{className:"sec-form__label",children:"Mật khẩu mới"}),s.jsxs("div",{className:"sec-form__input-wrapper",children:[s.jsx(p,{className:"sec-form__icon"}),s.jsx("input",{type:l?"text":"password",value:e.password,onChange:a=>n({...e,password:a.target.value}),placeholder:"Nhập mật khẩu mới",className:"sec-form__input",disabled:r}),s.jsx("button",{type:"button",onClick:()=>w(!l),className:"sec-form__toggle",children:l?s.jsx(m,{}):s.jsx(h,{})})]})]}),s.jsxs("div",{className:"sec-form__group",children:[s.jsx("label",{className:"sec-form__label",children:"Xác nhận mật khẩu mới"}),s.jsxs("div",{className:"sec-form__input-wrapper",children:[s.jsx(p,{className:"sec-form__icon"}),s.jsx("input",{type:d?"text":"password",value:e.password_confirmation,onChange:a=>n({...e,password_confirmation:a.target.value}),placeholder:"Xác nhận mật khẩu mới",className:"sec-form__input",disabled:r}),s.jsx("button",{type:"button",onClick:()=>g(!d),className:"sec-form__toggle",children:d?s.jsx(m,{}):s.jsx(h,{})})]})]}),s.jsx("button",{type:"submit",className:"sec-form__submit",disabled:r,children:r?s.jsxs(s.Fragment,{children:[s.jsx(M,{className:"sec-form__submit-icon sec-form__submit-icon--spinning"}),s.jsx("span",{children:"Đang xử lý..."})]}):"Đổi mật khẩu"})]})]})})};export{B as default};
