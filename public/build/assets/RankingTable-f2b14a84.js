import{c as U,l as ce,r as g,j as e,X as le,o as te,h as ee,n as ne,p as oe,k as de,b as he,q as ue,i as me}from"./app-4d58a1c1.js";import{C as ge}from"./clock-fb634083.js";import{C as re}from"./crown-80023408.js";import{S as W}from"./star-2e2e9a2f.js";import{G as ae}from"./gift-a60ca994.js";import{T as pe}from"./timer-024e62f0.js";import{A as fe}from"./arrow-right-0ebd1bc5.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=U("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=U("Medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=U("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=U("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=U("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);var Ne={exports:{}};(function(c,F){(function(x,R){c.exports=R()})(ce,function(){var x=1e3,R=6e4,h=36e5,S="millisecond",_="second",T="minute",D="hour",b="day",y="week",$="month",K="quarter",M="year",d="date",p="Invalid Date",f=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,C=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,V={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(r){var a=["th","st","nd","rd"],n=r%100;return"["+r+(a[(n-20)%10]||a[n]||a[0])+"]"}},O=function(r,a,n){var s=String(r);return!s||s.length>=a?r:""+Array(a+1-s.length).join(n)+r},Q={s:O,z:function(r){var a=-r.utcOffset(),n=Math.abs(a),s=Math.floor(n/60),t=n%60;return(a<=0?"+":"-")+O(s,2,"0")+":"+O(t,2,"0")},m:function r(a,n){if(a.date()<n.date())return-r(n,a);var s=12*(n.year()-a.year())+(n.month()-a.month()),t=a.clone().add(s,$),l=n-t<0,o=a.clone().add(s+(l?-1:1),$);return+(-(s+(n-t)/(l?t-o:o-t))||0)},a:function(r){return r<0?Math.ceil(r)||0:Math.floor(r)},p:function(r){return{M:$,y:M,w:y,d:b,D:d,h:D,m:T,s:_,ms:S,Q:K}[r]||String(r||"").toLowerCase().replace(/s$/,"")},u:function(r){return r===void 0}},E="en",L={};L[E]=V;var B="$isDayjsObject",X=function(r){return r instanceof H||!(!r||!r[B])},q=function r(a,n,s){var t;if(!a)return E;if(typeof a=="string"){var l=a.toLowerCase();L[l]&&(t=l),n&&(L[l]=n,t=l);var o=a.split("-");if(!t&&o.length>1)return r(o[0])}else{var m=a.name;L[m]=a,t=m}return!s&&t&&(E=t),t||!s&&E},v=function(r,a){if(X(r))return r.clone();var n=typeof a=="object"?a:{};return n.date=r,n.args=arguments,new H(n)},u=Q;u.l=q,u.i=X,u.w=function(r,a){return v(r,{locale:a.$L,utc:a.$u,x:a.$x,$offset:a.$offset})};var H=function(){function r(n){this.$L=q(n.locale,null,!0),this.parse(n),this.$x=this.$x||n.x||{},this[B]=!0}var a=r.prototype;return a.parse=function(n){this.$d=function(s){var t=s.date,l=s.utc;if(t===null)return new Date(NaN);if(u.u(t))return new Date;if(t instanceof Date)return new Date(t);if(typeof t=="string"&&!/Z$/i.test(t)){var o=t.match(f);if(o){var m=o[2]-1||0,k=(o[7]||"0").substring(0,3);return l?new Date(Date.UTC(o[1],m,o[3]||1,o[4]||0,o[5]||0,o[6]||0,k)):new Date(o[1],m,o[3]||1,o[4]||0,o[5]||0,o[6]||0,k)}}return new Date(t)}(n),this.init()},a.init=function(){var n=this.$d;this.$y=n.getFullYear(),this.$M=n.getMonth(),this.$D=n.getDate(),this.$W=n.getDay(),this.$H=n.getHours(),this.$m=n.getMinutes(),this.$s=n.getSeconds(),this.$ms=n.getMilliseconds()},a.$utils=function(){return u},a.isValid=function(){return this.$d.toString()!==p},a.isSame=function(n,s){var t=v(n);return this.startOf(s)<=t&&t<=this.endOf(s)},a.isAfter=function(n,s){return v(n)<this.startOf(s)},a.isBefore=function(n,s){return this.endOf(s)<v(n)},a.$g=function(n,s,t){return u.u(n)?this[s]:this.set(t,n)},a.unix=function(){return Math.floor(this.valueOf()/1e3)},a.valueOf=function(){return this.$d.getTime()},a.startOf=function(n,s){var t=this,l=!!u.u(s)||s,o=u.p(n),m=function(P,w){var Y=u.w(t.$u?Date.UTC(t.$y,w,P):new Date(t.$y,w,P),t);return l?Y:Y.endOf(b)},k=function(P,w){return u.w(t.toDate()[P].apply(t.toDate("s"),(l?[0,0,0,0]:[23,59,59,999]).slice(w)),t)},j=this.$W,N=this.$M,A=this.$D,z="set"+(this.$u?"UTC":"");switch(o){case M:return l?m(1,0):m(31,11);case $:return l?m(1,N):m(0,N+1);case y:var I=this.$locale().weekStart||0,Z=(j<I?j+7:j)-I;return m(l?A-Z:A+(6-Z),N);case b:case d:return k(z+"Hours",0);case D:return k(z+"Minutes",1);case T:return k(z+"Seconds",2);case _:return k(z+"Milliseconds",3);default:return this.clone()}},a.endOf=function(n){return this.startOf(n,!1)},a.$set=function(n,s){var t,l=u.p(n),o="set"+(this.$u?"UTC":""),m=(t={},t[b]=o+"Date",t[d]=o+"Date",t[$]=o+"Month",t[M]=o+"FullYear",t[D]=o+"Hours",t[T]=o+"Minutes",t[_]=o+"Seconds",t[S]=o+"Milliseconds",t)[l],k=l===b?this.$D+(s-this.$W):s;if(l===$||l===M){var j=this.clone().set(d,1);j.$d[m](k),j.init(),this.$d=j.set(d,Math.min(this.$D,j.daysInMonth())).$d}else m&&this.$d[m](k);return this.init(),this},a.set=function(n,s){return this.clone().$set(n,s)},a.get=function(n){return this[u.p(n)]()},a.add=function(n,s){var t,l=this;n=Number(n);var o=u.p(s),m=function(N){var A=v(l);return u.w(A.date(A.date()+Math.round(N*n)),l)};if(o===$)return this.set($,this.$M+n);if(o===M)return this.set(M,this.$y+n);if(o===b)return m(1);if(o===y)return m(7);var k=(t={},t[T]=R,t[D]=h,t[_]=x,t)[o]||1,j=this.$d.getTime()+n*k;return u.w(j,this)},a.subtract=function(n,s){return this.add(-1*n,s)},a.format=function(n){var s=this,t=this.$locale();if(!this.isValid())return t.invalidDate||p;var l=n||"YYYY-MM-DDTHH:mm:ssZ",o=u.z(this),m=this.$H,k=this.$m,j=this.$M,N=t.weekdays,A=t.months,z=t.meridiem,I=function(w,Y,G,J){return w&&(w[Y]||w(s,l))||G[Y].slice(0,J)},Z=function(w){return u.s(m%12||12,w,"0")},P=z||function(w,Y,G){var J=w<12?"AM":"PM";return G?J.toLowerCase():J};return l.replace(C,function(w,Y){return Y||function(G){switch(G){case"YY":return String(s.$y).slice(-2);case"YYYY":return u.s(s.$y,4,"0");case"M":return j+1;case"MM":return u.s(j+1,2,"0");case"MMM":return I(t.monthsShort,j,A,3);case"MMMM":return I(A,j);case"D":return s.$D;case"DD":return u.s(s.$D,2,"0");case"d":return String(s.$W);case"dd":return I(t.weekdaysMin,s.$W,N,2);case"ddd":return I(t.weekdaysShort,s.$W,N,3);case"dddd":return N[s.$W];case"H":return String(m);case"HH":return u.s(m,2,"0");case"h":return Z(1);case"hh":return Z(2);case"a":return P(m,k,!0);case"A":return P(m,k,!1);case"m":return String(k);case"mm":return u.s(k,2,"0");case"s":return String(s.$s);case"ss":return u.s(s.$s,2,"0");case"SSS":return u.s(s.$ms,3,"0");case"Z":return o}return null}(w)||o.replace(":","")})},a.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},a.diff=function(n,s,t){var l,o=this,m=u.p(s),k=v(n),j=(k.utcOffset()-this.utcOffset())*R,N=this-k,A=function(){return u.m(o,k)};switch(m){case M:l=A()/12;break;case $:l=A();break;case K:l=A()/3;break;case y:l=(N-j)/6048e5;break;case b:l=(N-j)/864e5;break;case D:l=N/h;break;case T:l=N/R;break;case _:l=N/x;break;default:l=N}return t?l:u.a(l)},a.daysInMonth=function(){return this.endOf($).$D},a.$locale=function(){return L[this.$L]},a.locale=function(n,s){if(!n)return this.$L;var t=this.clone(),l=q(n,s,!0);return l&&(t.$L=l),t},a.clone=function(){return u.w(this.$d,this)},a.toDate=function(){return new Date(this.valueOf())},a.toJSON=function(){return this.isValid()?this.toISOString():null},a.toISOString=function(){return this.$d.toISOString()},a.toString=function(){return this.$d.toUTCString()},r}(),i=H.prototype;return v.prototype=i,[["$ms",S],["$s",_],["$m",T],["$H",D],["$W",b],["$M",$],["$y",M],["$D",d]].forEach(function(r){i[r[1]]=function(a){return this.$g(a,r[0],r[1])}}),v.extend=function(r,a){return r.$i||(r(a,H,v),r.$i=!0),v},v.locale=q,v.isDayjs=X,v.unix=function(r){return v(1e3*r)},v.en=L[E],v.Ls=L,v.p={},v})})(Ne);const se=[{id:"level",label:"Level",icon:ke},{id:"honor",label:"Danh Tiếng",icon:re},{id:"gong",label:"Ác Danh",icon:ie},{id:"top-recharge",label:"Top Nạp",icon:ae},{id:"top-spend",label:"Top Tiêu",icon:W}],be=({status:c,claiming:F,onClaim:x})=>{const R=()=>{if(F)return e.jsxs("span",{className:"rer-button-content",children:[e.jsx(te,{className:"rer-button-icon rer-spin"}),"Đang nhận..."]});const h={claimed:e.jsx(oe,{className:"rer-button-icon"}),waiting:e.jsx(pe,{className:"rer-button-icon"}),not_eligible:e.jsx(de,{className:"rer-button-icon"}),can_claim:e.jsx(ae,{className:"rer-button-icon"})},S={claimed:"Đã nhận",waiting:"Chờ kết thúc event",not_eligible:"Chưa đủ điều kiện",can_claim:"Nhận quà"},_=c.status||c;return e.jsxs("span",{className:"rer-button-content",children:[h[_],S[_]]})};return e.jsx("button",{onClick:c==="can_claim"?x:void 0,disabled:c!=="can_claim"||F,className:`rer-button rer-button-${c}`,children:R()})},$e=({rankType:c,closeModal:F})=>{var M;const[x,R]=g.useState(c),[h,S]=g.useState({}),[_,T]=g.useState(!0),[D,b]=g.useState(!1);g.useEffect(()=>{const d=async p=>{if(!h[p])try{T(!0);const f=await ee.get(`/ranking-events/rewards/${p}`);f.data.success&&S(C=>({...C,[p]:{rewards:f.data.data.rewards||[],eventTime:f.data.data.event_time}}))}catch(f){console.error("Error fetching rewards:",f),ne.error("Không thể tải thông tin phần thưởng")}finally{T(!1)}};h[x]||d(x)},[x,h]);const y=g.useMemo(()=>h[x]||{rewards:[],eventTime:null},[h,x]),$=async d=>{var p,f;if(!D)try{if(b(!0),(await ee.post("/ranking-events/claim",{type:x,rank:d})).data.success){const V=await ee.get(`/ranking-events/rewards/${x}`);V.data.success&&S(O=>({...O,[x]:{rewards:V.data.data.rewards||[],eventTime:V.data.data.event_time}})),ne.success("Nhận quà thành công!")}}catch(C){console.error("Error claiming reward:",C),ne.error(((f=(p=C.response)==null?void 0:p.data)==null?void 0:f.message)||"Có lỗi xảy ra khi nhận quà")}finally{b(!1)}},K=g.useMemo(()=>{if(!y.rewards.length)return[];const d=new Map;return y.rewards.forEach(p=>{const f=p.rank_from;if(!d.has(f))d.set(f,{rank_from:p.rank_from,rank_to:p.rank_to,button_status:p.button_status,products:[...p.products]});else{const C=d.get(f);C.products=[...C.products,...p.products]}}),Array.from(d.values()).sort((p,f)=>p.rank_from-f.rank_from)},[y.rewards]);return e.jsx("div",{className:"rer-overlay",children:e.jsxs("div",{className:"rer-container",children:[e.jsxs("div",{className:"rer-sidebar",children:[e.jsxs("div",{className:"rer-sidebar-header",children:[e.jsx("div",{className:"rer-trophy-wrapper",children:e.jsx(je,{className:"rer-trophy-icon"})}),e.jsx("h3",{className:"rer-ranking-title",children:"Phần Thưởng Xếp Hạng"})]}),y.eventTime&&e.jsx("div",{className:"rer-event-timer",children:e.jsxs("div",{className:"rer-timer-content",children:[e.jsxs("h4",{className:"rer-timer-title",children:[e.jsx(ge,{className:"rer-timer-icon"}),"Thời Gian Sự Kiện"]}),e.jsxs("div",{className:"rer-timer-details",children:[e.jsxs("div",{className:"rer-time-box",children:[e.jsx("span",{className:"rer-time-label",children:"Bắt đầu:"}),e.jsx("p",{className:"rer-time-value",children:new Date(y.eventTime.start).toLocaleString("vi-VN")})]}),e.jsxs("div",{className:"rer-time-box",children:[e.jsx("span",{className:"rer-time-label",children:"Kết thúc:"}),e.jsx("p",{className:"rer-time-value",children:new Date(y.eventTime.end).toLocaleString("vi-VN")})]})]})]})}),e.jsx("div",{className:"rer-tabs",children:se.map(({id:d,label:p,icon:f})=>e.jsxs("button",{onClick:()=>R(d),className:`rer-tab ${x===d?"rer-tab-active":""}`,children:[e.jsx(f,{className:"rer-tab-icon"}),e.jsx("span",{className:"rer-tab-label",children:p})]},d))})]}),e.jsxs("div",{className:"rer-main",children:[e.jsxs("div",{className:"rer-header",children:[e.jsx("h2",{className:"rer-title",children:(M=se.find(d=>d.id===x))==null?void 0:M.label}),e.jsx("button",{onClick:F,className:"rer-close",children:e.jsx(le,{})})]}),e.jsx("div",{className:"rer-rewards",children:_&&!h[x]?e.jsxs("div",{className:"rer-loading",children:[e.jsx(te,{className:"rer-loading-icon rer-spin"}),e.jsx("p",{className:"rer-loading-text",children:"Đang tải thông tin phần thưởng..."})]}):K.map(d=>e.jsxs("div",{className:"rer-reward-card",children:[e.jsxs("div",{className:"rer-reward-header",children:[e.jsxs("div",{className:"rer-rank",children:[d.rank_from===1?e.jsx(re,{className:"rer-rank-icon rer-rank-gold"}):d.rank_from===2?e.jsx(xe,{className:"rer-rank-icon rer-rank-silver"}):d.rank_from===3?e.jsx(ie,{className:"rer-rank-icon rer-rank-bronze"}):e.jsx(W,{className:"rer-rank-icon rer-rank-normal"}),e.jsxs("div",{className:"rer-rank-text",children:[e.jsxs("h3",{children:["Top ",d.rank_from]}),d.rank_to!==d.rank_from&&e.jsxs("p",{children:["Đến Top ",d.rank_to]})]})]}),e.jsx(be,{status:d.button_status.status||d.button_status,claiming:D,onClaim:()=>$(d.rank_from)})]}),e.jsx("div",{className:"rer-items-grid",children:d.products.map((p,f)=>e.jsxs("div",{className:"rer-item",children:[e.jsx("img",{src:p.image,alt:p.name,className:"rer-item-image"}),e.jsx("div",{className:"rer-item-details",children:e.jsx("h4",{className:"rer-item-name",children:p.name})})]},f))})]},d.rank_from))})]})]})})};const Ce=()=>{const[c,F]=g.useState("level"),[x,R]=g.useState({}),[h,S]=g.useState(1),[_,T]=g.useState(!0),[D,b]=g.useState(null),[y,$]=g.useState({}),[K,M]=g.useState(!1),[d,p]=g.useState(!1);g.useState(null);const[f,C]=g.useState(null),[V,O]=g.useState(!1),Q=g.useMemo(()=>[{key:"level",label:"Level",shortLabel:"Level"},{key:"honor",label:"Top Danh Tiếng",shortLabel:"DT",icon:W},{key:"gong",label:"Top Ác Danh",shortLabel:"AD",icon:W},{key:"top-recharge",label:"Top Nạp",shortLabel:"Nạp",icon:W},{key:"top-spend",label:"Top Tiêu",shortLabel:"Tiêu",icon:W}],[]),E=g.useCallback(i=>({1:"text-yellow-400",2:"text-gray-400",3:"text-amber-600",4:"text-purple-400",5:"text-pink-400",6:"text-blue-400",7:"text-green-400",8:"text-indigo-400",9:"text-red-400"})[i]||"text-slate-300",[]),L=g.useCallback(i=>{if(!i)return{relative:"N/A",absolute:"N/A"};const a=new Date("2003-01-01T00:00:00+07:00").getTime()+i*1e3,n=new Date(a),s=new Date,t=n.toLocaleString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Asia/Ho_Chi_Minh"});if(n>s)return console.warn("Phát hiện thời gian tương lai:",{timestamp:i,calculatedTime:n.toString(),now:s.toString(),timeDiff:(n.getTime()-s.getTime())/1e3/60+" phút"}),{relative:"Vừa xong",absolute:t};const l=Math.floor((s.getTime()-n.getTime())/1e3);let o;return l<60?o="Vừa xong":l<3600?o=`${Math.floor(l/60)} phút trước`:l<86400?o=`${Math.floor(l/3600)} giờ trước`:o=`${Math.floor(l/86400)} ngày trước`,{relative:o,absolute:t}},[]),B=i=>{if(!i)return"***";if(i.length<=5)return i.charAt(0)+"****";{const r=Math.min(2,Math.floor(i.length/3));return i.substring(0,r)+"*".repeat(i.length-r-1)+i.charAt(i.length-1)}};g.useEffect(()=>{if(f>0){const i=setInterval(()=>{C(r=>r-1e3)},1e3);return()=>clearInterval(i)}},[f]);const X=i=>{if(i<=0)return"Đã kết thúc";const r=Math.floor(i/1e3),a=Math.floor(r/(60*60*24)),n=Math.floor(r%(60*60*24)/(60*60)),s=Math.floor(r%(60*60)/60),t=r%60;return`${a} ngày ${n} giờ ${s} phút ${t} giây`},q=g.useCallback(async(i=!1)=>{const r=`${c}_${h}`;if(!i&&x[r]){T(!1);return}try{i?M(!0):T(!0),b(null);const a=await he.get(`/api/rankings/${c}`,{params:{page:h,per_page:10}});if(a.data.success)R(n=>({...n,[r]:a.data.data})),$(n=>({...n,[c]:a.data.meta}));else throw new Error(a.data.message)}catch(a){b(a.message||"Có lỗi xảy ra khi tải bảng xếp hạng")}finally{T(!1),M(!1)}},[c,h,x]);g.useEffect(()=>{q()},[c,h,q]);const v=g.useCallback(()=>{var n;const i=((n=y[c])==null?void 0:n.last_page)||1,r=[];let a=new Set([1,i,h,h-1,h+1]);a=Array.from(a).filter(s=>s>=1&&s<=i).sort((s,t)=>s-t);for(let s=0;s<a.length;s++)s>0&&a[s]-a[s-1]>1&&r.push(e.jsx("span",{className:"ranking-ellipsis",children:"..."},`ellipsis-${s}`)),r.push(e.jsx("button",{onClick:()=>S(a[s]),className:`ranking-page-button ${h===a[s]?"ranking-page-button-active":""}`,children:a[s]},a[s]));return e.jsxs("div",{className:"ranking-pagination",children:[e.jsx("button",{onClick:()=>S(s=>Math.max(s-1,1)),disabled:h===1,className:`ranking-page-button ${h===1?"ranking-page-button-disabled":""}`,children:e.jsx(ue,{className:"w-4 h-4"})}),r,e.jsx("button",{onClick:()=>S(s=>Math.min(s+1,i)),disabled:h===i,className:`ranking-page-button ${h===i?"ranking-page-button-disabled":""}`,children:e.jsx(fe,{className:"w-4 h-4"})})]})},[h,y,c]),u=()=>V?me.createPortal(e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50 p-4",children:e.jsx($e,{rankType:c,closeModal:()=>O(!1)})}),document.getElementById("popup-root")):null,H=g.useMemo(()=>x[`${c}_${h}`]||[],[x,c,h]);return e.jsxs("div",{className:"ranking-section",children:[e.jsx("div",{className:"ranking-container",children:e.jsxs("div",{className:"ranking-card",children:[e.jsxs("div",{className:"ranking-header",children:[e.jsx("h2",{className:"ranking-title",children:"Bảng Xếp Hạng"}),e.jsx("hr",{className:"ranking-divider"}),e.jsxs("div",{className:"ranking-tabs",children:[e.jsxs("button",{onClick:()=>O(!0),className:"ranking-reward-button",children:[e.jsx(ae,{className:"w-4 h-4 md:w-5 md:h-5 mr-1 md:mr-2"}),e.jsx("span",{children:"Phần thưởng"})]}),Q.map(({key:i,label:r,shortLabel:a,icon:n})=>e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>{F(i),S(1),b(null)},className:`ranking-tab ${c===i?"ranking-tab-active":"ranking-tab-inactive"}`,children:[n&&e.jsx(n,{className:"w-4 h-4 md:w-5 md:h-5 mr-1 md:mr-2"}),e.jsx("span",{className:"hidden md:inline",children:r}),e.jsx("span",{className:"md:hidden",children:a})]}),["top-recharge","top-spend"].includes(i)&&d&&e.jsx("span",{className:"ranking-event-badge",children:"Sự kiện"})]},i))]}),d&&f!==null&&e.jsxs("p",{className:"ranking-countdown",children:["Thời gian xếp hạng Nạp, Tiêu còn lại: ",X(f)]})]}),e.jsx("div",{className:"ranking-content",children:_?e.jsxs("div",{className:"ranking-loading",children:[e.jsx("div",{className:"ranking-spinner"}),e.jsx("p",{children:"Đang tải dữ liệu..."})]}):D?e.jsxs("div",{className:"ranking-error",children:[e.jsx(ve,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("p",{children:D})]}):H.length===0?e.jsx("div",{className:"ranking-empty",children:e.jsx("p",{children:"Không có dữ liệu để hiển thị"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"md:hidden",children:H.map((i,r)=>{var a,n,s;return e.jsxs("div",{className:"ranking-mobile-card",children:[e.jsxs("div",{className:"ranking-mobile-header",children:[e.jsxs("span",{className:`ranking-position ${E((h-1)*10+r+1)}`,children:["#",(h-1)*10+r+1]}),e.jsx("span",{className:"ranking-player-name",children:["top-recharge","top-spend"].includes(c)?B(i.userid):i.userid})]}),e.jsxs("div",{className:"ranking-stats-grid",children:[c==="level"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"ranking-stat-box",children:[e.jsx("span",{className:"ranking-stat-label",children:"Level:"}),e.jsxs("span",{className:"ranking-stat-value",children:["Lv.",i.inner_level]})]}),e.jsxs("div",{className:"ranking-stat-box",children:[e.jsx("span",{className:"ranking-stat-label",children:"Tỷ lệ cấp:"}),e.jsxs("span",{className:"ranking-stat-value",children:[(i.level_rate*100).toFixed(2),"%"]})]})]}),c!=="level"&&c!=="top-recharge"&&c!=="top-spend"&&e.jsxs("div",{className:"ranking-stat-box col-span-2",children:[e.jsx("span",{className:"ranking-stat-label",children:c==="honor"?"Danh Tiếng:":"Ác Danh:"}),e.jsx("span",{className:"ranking-stat-value",children:(a=i[c])==null?void 0:a.toLocaleString()})]}),c==="top-recharge"&&e.jsxs("div",{className:"ranking-stat-box col-span-2",children:[e.jsx("span",{className:"ranking-stat-label",children:"Điểm Nạp:"}),e.jsx("span",{className:"ranking-stat-value",children:(n=i.char_event)==null?void 0:n.toLocaleString()})]}),c==="top-spend"&&e.jsxs("div",{className:"ranking-stat-box col-span-2",children:[e.jsx("span",{className:"ranking-stat-label",children:"Số Xu Đã Tiêu:"}),e.jsxs("span",{className:"ranking-stat-value",children:[(s=i.spent_coin)==null?void 0:s.toLocaleString()," xu"]})]}),c!=="top-recharge"&&c!=="top-spend"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"ranking-stat-box",children:[e.jsx("span",{className:"ranking-stat-label",children:"Môn Phái:"}),e.jsx("span",{className:"ranking-stat-value",children:i.party_name})]}),e.jsxs("div",{className:"ranking-stat-box",children:[e.jsx("span",{className:"ranking-stat-label",children:"Chức Trách:"}),e.jsx("span",{className:"ranking-stat-value",children:i.class_name})]})]}),c==="level"&&e.jsxs("div",{className:"ranking-stat-box col-span-2",children:[e.jsx("span",{className:"ranking-stat-label",children:"Thời gian lên cấp:"}),e.jsx("span",{className:"ranking-stat-value",children:L(i.levelup_time).relative}),e.jsx("span",{className:"ranking-stat-time-absolute",children:L(i.levelup_time).absolute})]})]})]},r)})}),e.jsx("div",{className:"hidden md:block",children:e.jsxs("table",{className:"ranking-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"ranking-table-header",children:"Xếp Hạng"}),e.jsx("th",{className:"ranking-table-header",children:c==="top-recharge"||c==="top-spend"?"Người dùng":"Nhân vật"}),c!=="top-recharge"&&c!=="top-spend"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"ranking-table-header",children:"Môn Phái"}),e.jsx("th",{className:"ranking-table-header",children:"Chức Trách"})]}),e.jsx("th",{className:"ranking-table-header",children:c==="level"?"Level":c==="honor"?"Danh Tiếng":c==="gong"?"Ác Danh":c==="top-recharge"?"Điểm Nạp":"Số Xu Đã Tiêu"}),c==="level"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"ranking-table-header",children:"Tỷ lệ cấp"}),e.jsx("th",{className:"ranking-table-header",children:"Thời gian lên cấp"})]})]})}),e.jsx("tbody",{children:H.map((i,r)=>{var a,n,s,t;return e.jsxs("tr",{className:"ranking-table-row",children:[e.jsx("td",{className:"ranking-table-cell",children:e.jsxs("span",{className:`ranking-position ${E((h-1)*10+r+1)}`,children:["#",(h-1)*10+r+1]})}),e.jsx("td",{className:"ranking-table-cell",children:e.jsx("span",{className:"ranking-player-name",children:["top-recharge","top-spend"].includes(c)?B(i.userid):i.chr_name})}),c!=="top-recharge"&&c!=="top-spend"&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"ranking-table-cell",children:e.jsx("span",{className:"ranking-party-name",children:i.party_name})}),e.jsx("td",{className:"ranking-table-cell",children:e.jsx("span",{className:"ranking-class-name",children:i.class_name})})]}),e.jsx("td",{className:"ranking-table-cell",children:e.jsx("span",{className:"ranking-stat-value",children:c==="level"?`Lv.${i.inner_level}`:c==="honor"?(a=i.honor)==null?void 0:a.toLocaleString():c==="gong"?(n=i.gong)==null?void 0:n.toLocaleString():c==="top-recharge"?(s=i.char_event)==null?void 0:s.toLocaleString():`${(t=i.spent_coin)==null?void 0:t.toLocaleString()} xu`})}),c==="level"&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"ranking-table-cell",children:e.jsxs("span",{className:"ranking-level-rate",children:[(i.level_rate*100).toFixed(2),"%"]})}),e.jsxs("td",{className:"ranking-table-cell",children:[e.jsx("span",{className:"ranking-levelup-time",children:L(i.levelup_time).relative}),e.jsx("span",{className:"ranking-levelup-time-absolute",children:L(i.levelup_time).absolute})]})]})]},r)})})]})}),v()]})})]})}),u()]})};export{Ce as default};
